@model List<ElliotDvp_tarea04.Models.Lista>

<h1>Lista de Razas de Perros</h1>

<div style="margin-bottom: 20px;">
    <label for="filtro-categoria">Filtrar por categoría:</label>
    <select id="filtro-categoria">
        <option value="todas">Todas las categorías</option>
        <option value="Perros pequeños">Perros pequeños</option>
        <option value="Perros familiares">Perros familiares</option>
        <option value="Perros raros">Perros raros</option>
        <option value="Perros guardianes">Perros guardianes</option>
        <option value="Perros para apartamento">Perros para apartamento</option>
    </select>
    <button id="btn-filtrar">Filtrar</button>
</div>

<div class="grid-container" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px;">
    @foreach (var perro in Model)
    {
        <div class="perro-card" data-categoria="@perro.Categoria" 
             style="border: 1px solid #ddd; padding: 15px; border-radius: 8px; cursor: pointer;"
             onclick="mostrarDetallePerro(this)">
            <img src="@perro.ImagenUrl" alt="@perro.Nombre" style="width: 100%; height: 200px; object-fit: cover; border-radius: 5px;">
            <h3 style="margin: 10px 0;">@perro.Nombre</h3>
            <p style="color: #666;">@(perro.Descripcion?.Length > 100 ? perro.Descripcion.Substring(0, 100) + "..." : perro.Descripcion ?? "Sin descripción disponible")</p>
            
            <div class="hidden-data" 
                 data-nombre="@perro.Nombre"
                 data-edad="@perro.Edad"
                 data-tamano="@perro.Tamano"
                 data-peso="@perro.Peso"
                 data-descripcion="@perro.Descripcion"
                 data-imagen="@perro.ImagenUrl"
                 data-categoria="@perro.Categoria"
                 style="display: none;"></div>
        </div>
    }
</div>

<div id="detalle-perro" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.2); z-index: 1000; max-width: 600px; width: 90%;">
    <button onclick="cerrarDetalle()" style="position: absolute; top: 10px; right: 10px; background: none; border: none; font-size: 20px; cursor: pointer;">×</button>
    <h2 id="detalle-nombre" style="margin-top: 0;"></h2>
    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
        <img id="detalle-imagen" src="" alt="Imagen del perro" style="max-width: 250px; border-radius: 5px;">
        <div>
            <p><b>Categoría:</b> <span id="detalle-categoria"></span></p>
            <p><b>Edad Promedio:</b> <span id="detalle-edad"></span></p>
            <p><b>Tamaño:</b> <span id="detalle-tamano"></span></p>
            <p><b>Peso Promedio:</b> <span id="detalle-peso"></span></p>
        </div>
    </div>
    <p id="detalle-descripcion" style="margin-top: 20px;"></p>
</div>
<div id="overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 999;"></div>

<script>
    function mostrarDetallePerro(element) {
        const hiddenData = element.querySelector('.hidden-data');
        
        document.getElementById("detalle-perro").style.display = "block";
        document.getElementById("overlay").style.display = "block";
        
        document.getElementById("detalle-nombre").textContent = hiddenData.dataset.nombre;
        document.getElementById("detalle-categoria").textContent = hiddenData.dataset.categoria;
        document.getElementById("detalle-edad").textContent = hiddenData.dataset.edad;
        document.getElementById("detalle-tamano").textContent = hiddenData.dataset.tamano;
        document.getElementById("detalle-peso").textContent = hiddenData.dataset.peso;
        document.getElementById("detalle-descripcion").textContent = hiddenData.dataset.descripcion;
        document.getElementById("detalle-imagen").src = hiddenData.dataset.imagen;
    }

    function cerrarDetalle() {
        document.getElementById("detalle-perro").style.display = "none";
        document.getElementById("overlay").style.display = "none";
    }

    document.getElementById("btn-filtrar").addEventListener("click", function() {
        const categoriaSeleccionada = document.getElementById("filtro-categoria").value;
        const cards = document.querySelectorAll(".perro-card");
        
        cards.forEach(card => {
            if (categoriaSeleccionada === "todas" || card.dataset.categoria === categoriaSeleccionada) {
                card.style.display = "block";
            } else {
                card.style.display = "none";
            }
        });
        
        const detalleVisible = document.getElementById("detalle-perro").style.display === "block";
        if (detalleVisible) {
            const categoriaDetalle = document.getElementById("detalle-categoria").textContent;
            if (categoriaSeleccionada !== "todas" && categoriaDetalle !== categoriaSeleccionada) {
                cerrarDetalle();
            }
        }
    });
</script>
